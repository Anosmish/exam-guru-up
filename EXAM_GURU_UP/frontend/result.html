<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Quiz Result</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .correct { color: green; font-weight: bold; }
        .wrong { color: red; font-weight: bold; }
        .box {
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 8px;
            background: #f4f4f4;
        }
        .performance {
            font-size: 20px;
            margin: 15px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h2>üìä Quiz Result</h2>

<h3 id="score"></h3>
<h4 id="percentage"></h4>
<div id="performance" class="performance"></div>

<hr>

<div id="analysis"></div>

<br>
<button onclick="goToDashboard()">
    ‚Üê Back to Dashboard
</button>
<script src="config.js"></script>
<script>
function goToDashboard(){

    const user = JSON.parse(localStorage.getItem("user"));

    if(!user){
        window.location.href = "../login.html";
        return;
    }

    if(user.role === "admin"){
        window.location.href = "../admin/admin-dashboard.html";
        return;
    }

    if(user.category && user.category.dashboard){
        window.location.href = user.category.dashboard.route;
    } else {
        alert("Dashboard not assigned.");
    }
}
const data = JSON.parse(localStorage.getItem("resultData"));

if (!data || !data.answers) {
    document.body.innerHTML = "<h3>No result data found</h3>";
    throw new Error("No result data");
}

// ‚úÖ Calculate max possible score based on difficulty
let maxScore = 0;

data.answers.forEach(item => {

    if (item.difficulty === "Hard") {
        maxScore += 3;
    }
    else if (item.difficulty === "Medium") {
        maxScore += 2;
    }
    else {
        maxScore += 1;
    }

});

// fallback if difficulty missing
if (maxScore === 0) {
    maxScore = data.total;
}

// ‚úÖ Correct percentage calculation
let percent = ((data.score / maxScore) * 100).toFixed(2);

// ‚úÖ Show score
document.getElementById("score").innerText =
    `Score: ${data.score} / ${maxScore}`;

document.getElementById("percentage").innerText =
    `Percentage: ${percent}%`;


// üéØ Performance Message
let performanceMsg = "";

if (percent >= 80) {
    performanceMsg = "üåü Excellent Performance!";
}
else if (percent >= 50) {
    performanceMsg = "üëç Good Job!";
}
else {
    performanceMsg = "‚ö†Ô∏è Needs Improvement. Keep Practicing!";
}

document.getElementById("performance").innerText = performanceMsg;


// ‚úÖ Detailed Analysis
const analysisDiv = document.getElementById("analysis");

analysisDiv.innerHTML = "";

data.answers.forEach((item, index) => {

    const isCorrect = item.selectedAnswer === item.correctAnswer;

    let optionsHTML = "";

    for (let key in item.options) {

        let className = "";

        if (key === item.correctAnswer) {
            className = "correct";
        }

        if (key === item.selectedAnswer && !isCorrect) {
            className = "wrong";
        }

        optionsHTML += `
            <p class="${className}">
                ${key}. ${item.options[key]}
            </p>
        `;
    }

    analysisDiv.innerHTML += `
        <div class="box">
            <p><strong>Q${index + 1}:</strong> ${item.question}</p>
            ${optionsHTML}
            <p>
                <strong>Your Answer:</strong> 
                <span class="${isCorrect ? 'correct' : 'wrong'}">
                    ${item.selectedAnswer}
                </span>
            </p>
            <p>
                <strong>Correct Answer:</strong> 
                ${item.correctAnswer}
            </p>
        </div>
    `;

});

</script>



</body>
</html>
